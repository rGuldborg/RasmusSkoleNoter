### i. HTML Struktur

```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Experiment with fetch</title>
</head>
<body>
  <h1>Kopier url til input felt og tryk fetch</h1>
  <!-- Inputfelt til URL -->
  <input type="text" id="inpUrl" size="40">

  <!-- Knappen, der starter fetch -->
  <button id="pbFetchUrl">Fetch url</button>

  <br><br>

  <!-- Textarea til output af fetch result -->
  <textarea id="txt" rows="40" cols="100"></textarea>

  <!-- Inkluderer JS fil -->
  <script src="js/fetchurl.js"></script>
</body>
</html>
```


---

### ii. fetchurl.js – Simpel test og binding af knap

```javascript
// Test for at se, at filen loader korrekt
console.log("im in fetchurl");

// Funktion til at vise tekst fra inputfelt i textarea
function actionFetchUrl(btn) {
  const url = inpUrl.value;  // Hent værdien fra inputfelt
  console.log(url);          // Log til console for debugging
  textArea.textContent = url; // Vis input i textarea
}

// Hent referencer til HTML elementer
const inpUrl = document.getElementById("inpUrl");
const textArea = document.getElementById("txt");
const pbFetch = document.getElementById("pbFetchUrl");

// Tilføj eventlistener til knap, så actionFetchUrl kaldes ved klik
pbFetch.addEventListener('click', actionFetchUrl);
```


- Her kan du teste, at bindingen til HTML virker, før du arbejder med fetch.
    

---

### iii. Fetch funktion

```javascript
// Funktion til at hente JSON fra en URL
function fetchAnyUrl(url) {
  console.log("inside fetch url=" + url);
  // fetch returnerer en Promise → .then() kører, når data er hentet
  return fetch(url).then(response => response.json());
}

// Async funktion, der kalder fetchAnyUrl og viser resultat
async function actionFetchUrl(btn) {
  const url = inpUrl.value;
  console.log(url);

  // Vent på at fetch er færdig
  const jsonOutput = await fetchAnyUrl(url);

  // Vis JSON som tekst i textarea
  textArea.textContent = JSON.stringify(jsonOutput, null, 2);
  console.log(jsonOutput);
}
```


**Kommentarer:**

- `async` markerer funktionen som asynkron → kan bruge `await`.
    
- `await` sikrer, at vi venter på fetch-resultatet, før vi går videre.
    
- `JSON.stringify(obj, null, 2)` formaterer JSON pænt i textarea.
    

---

### iv. Alternativ: Hent som tekst

```javascript
function fetchAnyUrlText(url) {
  console.log("inside fetch text url=" + url);
  // Returnerer raw tekst i stedet for JSON
  return fetch(url).then(response => response.text());
}
```


- Brug denne, hvis API ikke returnerer JSON, men fx HTML eller CSV.
    

---

### v. Arbejde med JSON objekter

```javascript
// Eksempel objekt
const obj = {
  prop1: 'value1',
  prop2: 'value2',
  prop3: 'value3'
};

// Få første property navn og value
const firstProperty = Object.keys(obj)[0]; // 'prop1'
console.log(firstProperty);
console.log(obj[firstProperty]);           // 'value1'

// Konverter JSON array til tekst (eksempel med regioner)
function convertJsonToText2(json) {
  const txt = json.map(region => `{"region": "${region.kode}"}`).join(',\n');
  return txt;
}

// Få keys og values fra et objekt
function getKeysAndValuesFromObj(obj) {
  const keys = Object.keys(obj);
  return keys.map(key => `${key}: ${obj[key]}`);
}

// Async funktion, der tjekker om JSON er array eller objekt
async function actionFetchUrl(btn) {
  const url = inpUrl.value;
  console.log(url);
  const jsonOutput = await fetchAnyUrl(url);

  let showTxt = "";
  if (Array.isArray(jsonOutput)) {
    // Hvis array, vis keys/values af første element
    showTxt = getKeysAndValuesFromObj(jsonOutput[0]);
  } else {
    // Hvis enkelt objekt, vis keys/values
    showTxt = getKeysAndValuesFromObj(jsonOutput);
  }

  textArea.textContent = showTxt;
  console.log(jsonOutput);
}
```


**Kommentarer:**

- `Array.isArray(jsonOutput)` tjekker om data er et array.
    
- `Object.keys(obj)` henter alle properties (keys) fra et objekt.
    
- `.map()` bruges til at formatere key/value par.
    

---

## JavaScript Kommune Dropdown

### i. HTML Struktur

```html
<body>
  <!-- Dropdown til kommuner -->
  <select id="ddKommuner"></select>

  <!-- Knap til at fylde dropdown -->
  <button id="pbFetchKommuner">Fyld dropdown</button>

  <script src="js/kommunedropdown.js"></script>
</body>
</html>
```


---

### ii. kommunedropdown.js

```javascript
// URL til Danmarks kommuner
const urlKommune = "https://api.dataforsyningen.dk/kommuner";

// Funktion til at hente kommuner fra API
function fetchKommuner(any) {
  return fetch(any).then(response => response.json());
}

// Async funktion til at fylde dropdown
async function actionFetch() {
  const kommuner = await fetchKommuner(urlKommune);

  // Hent dropdown element
  const dd = document.getElementById("ddKommuner");

  // Sorter kommuner alfabetisk
  kommuner.sort((a, b) => a.navn.localeCompare(b.navn));

  // Ryd dropdown først
  dd.innerHTML = "";

  // Indsæt hver kommune i dropdown
  kommuner.forEach(item => {
    const option = document.createElement("option");
    option.value = item.kode;     // Primary key i value
    option.textContent = item.navn; // Vis navn i dropdown
    dd.appendChild(option);
  });
}

// Tilføj eventlistener til knap
const pbFetchKommuner = document.getElementById("pbFetchKommuner");
pbFetchKommuner.addEventListener('click', actionFetch);
```


**Kommentarer:**

- `await fetchKommuner(urlKommune)` sikrer, at vi får arrayet inden vi arbejder videre.
    
- `localeCompare` bruges til alfabetisk sortering af strings.
    
- `document.createElement("option")` dynamisk tilføjelse til dropdown.
    

---

### iii. Avanceret opgave

- Når en kommune vælges i dropdown, kan man dynamisk oprette et `<a>` tag med `href`.
    
- Alternativt: Inputfelt hvor man skriver kommunenavn → find match i dropdown → generer `<a>` tag.